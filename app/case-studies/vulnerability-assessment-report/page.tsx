// app/case-studies/vulnerability-assessment-report/page.tsx

"use client"

import React from "react"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { AlertTriangle, CheckCircle2, Shield, Code2, ArrowLeft, ArrowRight } from "lucide-react"
import Link from "next/link"
import { AnimatedText } from "@/components/animated-text"

export default function VulnerabilityAssessmentReportPage() {
  return (
    <div className="container-margin py-12 pt-24 pb-16"> {/* Reduced top padding for mobile */}
      <div className="max-w-4xl mx-auto px-4">
        {/* Back Button */}
        <Link href="/case-studies">
          <Button variant="ghost" className="mb-6 text-sm">
            <ArrowLeft className="mr-2 h-4 w-4" /> Back to Case Studies
          </Button>
        </Link>

        {/* Title */}
        <div className="mb-10 text-center sm:text-left">
          <AnimatedText as="h1" className="text-3xl sm:text-4xl md:text-5xl font-bold mb-6 shadow-text flex flex-col sm:flex-row items-center gap-4">
            <Shield className="h-10 w-10 sm:h-12 sm:w-12 text-red-500 flex-shrink-0" />
            <span>Vulnerability Assessment Report</span>
          </AnimatedText>
        </div>

        <div className="space-y-12 text-muted-foreground">
          {/* 1. Vulnerability Title & Severity */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5 flex items-center gap-3">
              <AlertTriangle className="h-7 w-7 sm:h-8 sm:w-8 text-red-500 flex-shrink-0" />
              1. Vulnerability Title
            </h2>
            <Card className="border-red-200 bg-red-50/50">
              <CardContent className="pt-5">
                <p className="text-xl sm:text-2xl font-semibold text-red-600">
                  Information Disclosure via Verbose Error Messages
                </p>
              </CardContent>
            </Card>

            <div className="mt-6">
              <h3 className="text-xl sm:text-2xl font-bold mb-3">2. Severity</h3>
              <Badge variant="destructive" className="text-base sm:text-lg px-5 py-2">
                High
              </Badge>
            </div>
          </section>

          {/* 3. Vulnerability Type */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">3. Vulnerability Type</h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Category</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2 text-sm sm:text-base">
                    <li className="flex items-center gap-2">
                      <CheckCircle2 className="h-4 w-4 sm:h-5 sm:w-5 text-primary flex-shrink-0" />
                      Information Disclosure
                    </li>
                    <li className="flex items-center gap-2">
                      <CheckCircle2 className="h-4 w-4 sm:h-5 sm:w-5 text-primary flex-shrink-0" />
                      Security Misconfiguration
                    </li>
                  </ul>
                </CardContent>
              </Card>
              <Card className="sm:col-span-2 lg:col-span-1">
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">OWASP Reference</CardTitle>
                </CardHeader>
                <CardContent>
                  <Badge variant="secondary" className="text-sm sm:text-base">
                    OWASP Top 10 – A05: Security Misconfiguration
                  </Badge>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 4. Affected Component */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">4. Affected Component</h2>
            <Card>
              <CardContent className="pt-5">
                <ul className="space-y-2 text-sm sm:text-base">
                  <li>• Public API endpoints</li>
                  <li>• Invalid or non-existent routes</li>
                </ul>
              </CardContent>
            </Card>
          </section>

          {/* 5. Description */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">5. Description</h2>
            <Card>
              <CardContent className="pt-5 leading-relaxed text-sm sm:text-base">
                <p>
                  The application exposes detailed internal error information when an invalid API route or malformed path is requested.
                </p>
                <p className="mt-4">
                  The error response includes full server file paths, framework internals, middleware stack, and execution traces. This behavior allows an attacker to gain sensitive information about the server environment, application structure, and underlying framework.
                </p>
              </CardContent>
            </Card>
          </section>

          {/* 6. Proof of Concept */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5 flex items-center gap-3">
              <Code2 className="h-7 w-7 sm:h-8 sm:w-8 text-primary flex-shrink-0" />
              6. Proof of Concept (PoC)
            </h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Request</CardTitle>
                </CardHeader>
                <CardContent>
                  <code className="text-xs sm:text-sm break-all block bg-muted p-3 rounded">
                    GET /home/
                    <span className="blur-sm select-none">myqbits/api.myqbits.com</span>
                    /vendor/laravel/framework/src/Illuminate/Routing/Router.php
                  </code>
                </CardContent>
              </Card>
              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Response Highlights</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2 text-sm sm:text-base">
                    <li>• Full internal server paths</li>
                    <li>• Laravel framework file locations</li>
                    <li>• Stack trace details</li>
                    <li>• Middleware execution order</li>
                  </ul>
                  <p className="mt-4 text-sm sm:text-base font-mono">
                    Example path exposed:<br />
                    <span className="text-red-600 break-all">
                      /home/<span className="blur-sm select-none">myqbits/api.myqbits.com</span>/vendor/laravel/framework/
                    </span>
                  </p>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 7. Impact */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">7. Impact</h2>
            <Card className="border-orange-200 bg-orange-50/50">
              <CardContent className="pt-5 text-sm sm:text-base">
                <p className="mb-4">An attacker can leverage this information to:</p>
                <ul className="space-y-2">
                  <li>• Identify the backend framework (Laravel)</li>
                  <li>• Perform framework-specific attacks</li>
                  <li>• Target known vulnerabilities (CVEs)</li>
                  <li>• Map internal directory structure</li>
                  <li>• Assist in Local File Inclusion (LFI) or Remote Code Execution (RCE) reconnaissance</li>
                </ul>
                <p className="mt-6 font-semibold text-orange-700">
                  This significantly increases the risk of further exploitation.
                </p>
              </CardContent>
            </Card>
          </section>

          {/* 8. Root Cause */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">8. Root Cause</h2>
            <Card>
              <CardContent className="pt-5 text-sm sm:text-base">
                <ul className="space-y-2">
                  <li>• Debug mode enabled in production environment (APP_DEBUG=true)</li>
                  <li>• Default exception handler returning verbose error details</li>
                  <li>• Lack of API-specific error sanitization</li>
                </ul>
              </CardContent>
            </Card>
          </section>

          {/* 9. Recommendation / Remediation */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5 flex items-center gap-3">
              <CheckCircle2 className="h-7 w-7 sm:h-8 sm:w-8 text-green-500 flex-shrink-0" />
              9. Recommendation / Remediation
            </h2>
            <div className="grid grid-cols-1 gap-6">
              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Immediate Fix</CardTitle>
                </CardHeader>
                <CardContent>
                  <code className="bg-muted px-4 py-3 rounded block text-sm">
                    APP_ENV=production<br />
                    APP_DEBUG=false
                  </code>
                </CardContent>
              </Card>

              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Code-Level Fix</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2 text-sm sm:text-base">
                    <li>• Implement a custom API-safe exception handler</li>
                    <li>• Return generic error messages for all client-facing API responses</li>
                    <li>• Log detailed errors internally only</li>
                  </ul>
                </CardContent>
              </Card>

              <Card>
                <CardHeader className="pb-3">
                  <CardTitle className="text-base sm:text-lg">Best Practices</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2 text-sm sm:text-base">
                    <li>• Never expose stack traces or file paths in production</li>
                    <li>• Use centralized error handling for APIs</li>
                    <li>• Apply rate limiting on invalid routes</li>
                    <li>• Regularly audit error responses</li>
                  </ul>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 10. Expected Secure Behavior */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">10. Expected Secure Behavior</h2>
            <Card>
              <CardContent className="pt-5 text-sm sm:text-base">
                <p className="mb-4">For invalid routes, the API should respond with a minimal message:</p>
                <pre className="bg-muted p-4 rounded text-sm overflow-x-auto">
{`{
  "success": false,
  "message": "Endpoint not found"
}`}
                </pre>
                <p className="mt-4 font-semibold">No internal details should be exposed.</p>
              </CardContent>
            </Card>
          </section>

          {/* 11. Conclusion */}
          <section>
            <h2 className="text-2xl sm:text-3xl font-bold mb-5">11. Conclusion</h2>
            <Card className="border-red-200 bg-red-50/50">
              <CardContent className="pt-5 text-base sm:text-lg">
                <p>
                  This vulnerability represents a <strong className="text-red-600">high-risk information disclosure issue</strong> that can significantly aid attackers during reconnaissance.
                </p>
                <p className="mt-4 font-semibold">
                  Immediate remediation is strongly recommended to prevent further exploitation.
                </p>
              </CardContent>
            </Card>
          </section>
        </div>

        {/* Final CTA */}
        <div className="text-center mt-12">
          <Link href="/contact">
            <Button size="lg" className="w-full sm:w-auto hover-lift shadow-primary-hover text-base px-8 py-6">
              Need a Security Assessment for Your Application?
              <ArrowRight className="ml-2 h-5 w-5" />
            </Button>
          </Link>
        </div>
      </div>
    </div>
  )
}