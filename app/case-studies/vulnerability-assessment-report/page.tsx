// app/case-studies/vulnerability-assessment-report/page.tsx


"use client"

import React from "react"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { AlertTriangle, CheckCircle2, Shield, Code2, ArrowLeft, ArrowRight } from "lucide-react"
import Link from "next/link"
import { AnimatedText } from "@/components/animated-text"

export default function VulnerabilityAssessmentReportPage() {
  return (
    <div className="container-margin py-16 pt-32">
      <div className="max-w-5xl mx-auto px-4">
        <Link href="/case-studies">
          <Button variant="ghost" className="mb-8">
            <ArrowLeft className="mr-2 h-4 w-4" /> Back to Case Studies
          </Button>
        </Link>

        <AnimatedText as="h1" className="text-4xl sm:text-5xl font-bold mb-8 shadow-text flex items-center gap-4">
          <Shield className="h-12 w-12 text-red-500" />
          Vulnerability Assessment Report
        </AnimatedText>

        <div className="prose prose-lg max-w-none space-y-12 text-muted-foreground">
          {/* 1. Vulnerability Title & Severity */}
          <section>
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <AlertTriangle className="h-8 w-8 text-red-500" />
              1. Vulnerability Title
            </h2>
            <Card className="border-red-200 bg-red-50/50">
              <CardContent className="pt-6">
                <p className="text-2xl font-semibold text-red-600">
                  Information Disclosure via Verbose Error Messages
                </p>
              </CardContent>
            </Card>

            <div className="mt-8">
              <h3 className="text-2xl font-bold mb-4">2. Severity</h3>
              <Badge variant="destructive" className="text-lg px-6 py-2">
                High
              </Badge>
            </div>
          </section>

          {/* 3. Vulnerability Type */}
          <section>
            <h2 className="text-3xl font-bold mb-6">3. Vulnerability Type</h2>
            <div className="grid md:grid-cols-3 gap-4">
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">Category</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    <li className="flex items-center gap-2">
                      <CheckCircle2 className="h-5 w-5 text-primary" />
                      Information Disclosure
                    </li>
                    <li className="flex items-center gap-2">
                      <CheckCircle2 className="h-5 w-5 text-primary" />
                      Security Misconfiguration
                    </li>
                  </ul>
                </CardContent>
              </Card>
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">OWASP Reference</CardTitle>
                </CardHeader>
                <CardContent>
                  <Badge variant="secondary" className="text-base">
                    OWASP Top 10 – A05: Security Misconfiguration
                  </Badge>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 4. Affected Component */}
          <section>
            <h2 className="text-3xl font-bold mb-6">4. Affected Component</h2>
            <Card>
              <CardContent className="pt-6">
                <ul className="space-y-2">
                  <li>• Public API endpoints</li>
                  <li>• Invalid or non-existent routes</li>
                </ul>
              </CardContent>
            </Card>
          </section>

          {/* 5. Description */}
          <section>
            <h2 className="text-3xl font-bold mb-6">5. Description</h2>
            <Card>
              <CardContent className="pt-6 leading-relaxed">
                <p>
                  The application exposes detailed internal error information when an invalid API route or malformed path is requested.
                </p>
                <p className="mt-4">
                  The error response includes full server file paths, framework internals, middleware stack, and execution traces. This behavior allows an attacker to gain sensitive information about the server environment, application structure, and underlying framework.
                </p>
              </CardContent>
            </Card>
          </section>

          {/* 6. Proof of Concept */}
          <section>
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Code2 className="h-8 w-8 text-primary" />
              6. Proof of Concept (PoC)
            </h2>
            <div className="grid md:grid-cols-2 gap-6">
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">Request</CardTitle>
                </CardHeader>
                <CardContent>
                  <code className="text-sm break-all">
                    GET /home/
                    <span className="blur-sm select-none">
                      myqbits/api.myqbits.com
                    </span>
                    /vendor/laravel/framework/src/Illuminate/Routing/Router.php
                  </code>
                </CardContent>

              </Card>
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">Response Highlights</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="text-sm space-y-1">
                    <li>• Full internal server paths</li>
                    <li>• Laravel framework file locations</li>
                    <li>• Stack trace details</li>
                    <li>• Middleware execution order</li>
                  </ul>
                  <p className="mt-4 text-sm font-mono">
                    Example path exposed:<br />
                    <span className="text-red-600">/home/<span className="blur-sm select-none">
                      myqbits/api.myqbits.com
                    </span>/vendor/laravel/framework/</span>
                  </p>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 7. Impact */}
          <section>
            <h2 className="text-3xl font-bold mb-6">7. Impact</h2>
            <Card className="border-orange-200 bg-orange-50/50">
              <CardContent className="pt-6">
                <p className="mb-4">An attacker can leverage this information to:</p>
                <ul className="space-y-2">
                  <li>• Identify the backend framework (Laravel)</li>
                  <li>• Perform framework-specific attacks</li>
                  <li>• Target known vulnerabilities (CVEs)</li>
                  <li>• Map internal directory structure</li>
                  <li>• Assist in Local File Inclusion (LFI) or Remote Code Execution (RCE) reconnaissance</li>
                </ul>
                <p className="mt-6 font-semibold text-orange-700">
                  This significantly increases the risk of further exploitation.
                </p>
              </CardContent>
            </Card>
          </section>

          {/* 8. Root Cause */}
          <section>
            <h2 className="text-3xl font-bold mb-6">8. Root Cause</h2>
            <Card>
              <CardContent className="pt-6">
                <ul className="space-y-2">
                  <li>• Debug mode enabled in production environment (APP_DEBUG=true)</li>
                  <li>• Default exception handler returning verbose error details</li>
                  <li>• Lack of API-specific error sanitization</li>
                </ul>
              </CardContent>
            </Card>
          </section>

          {/* 9. Recommendation / Remediation */}
          <section>
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <CheckCircle2 className="h-8 w-8 text-green-500" />
              9. Recommendation / Remediation
            </h2>
            <div className="space-y-8">
              <Card>
                <CardHeader>
                  <CardTitle>Immediate Fix</CardTitle>
                </CardHeader>
                <CardContent>
                  <code className="bg-muted px-4 py-3 rounded block">
                    APP_ENV=production<br />
                    APP_DEBUG=false
                  </code>
                </CardContent>
              </Card>

              <Card>
                <CardHeader>
                  <CardTitle>Code-Level Fix</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    <li>• Implement a custom API-safe exception handler</li>
                    <li>• Return generic error messages for all client-facing API responses</li>
                    <li>• Log detailed errors internally only</li>
                  </ul>
                </CardContent>
              </Card>

              <Card>
                <CardHeader>
                  <CardTitle>Best Practices</CardTitle>
                </CardHeader>
                <CardContent>
                  <ul className="space-y-2">
                    <li>• Never expose stack traces or file paths in production</li>
                    <li>• Use centralized error handling for APIs</li>
                    <li>• Apply rate limiting on invalid routes</li>
                    <li>• Regularly audit error responses</li>
                  </ul>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* 10. Expected Secure Behavior */}
          <section>
            <h2 className="text-3xl font-bold mb-6">10. Expected Secure Behavior</h2>
            <Card>
              <CardContent className="pt-6">
                <p className="mb-4">For invalid routes, the API should respond with a minimal message:</p>
                <pre className="bg-muted p-4 text-yellow-500 rounded">
{`{
  "success": false,
  "message": "Endpoint not found"
}`}
                </pre>
                <p className="mt-4 font-semibold">No internal details should be exposed.</p>
              </CardContent>
            </Card>
          </section>

          {/* 11. Conclusion */}
          <section>
            <h2 className="text-3xl font-bold mb-6">11. Conclusion</h2>
            <Card className="border-red-200 bg-red-50/50">
              <CardContent className="pt-6 text-lg">
                <p>
                  This vulnerability represents a <strong className="text-red-600">high-risk information disclosure issue</strong> that can significantly aid attackers during reconnaissance.
                </p>
                <p className="mt-4 font-semibold">
                  Immediate remediation is strongly recommended to prevent further exploitation.
                </p>
              </CardContent>
            </Card>
          </section>
        </div>

        {/* Final CTA */}
        <div className="text-center mt-16">
          <Link href="/contact">
            <Button size="lg" className="hover-lift shadow-primary-hover">
              Need a Security Assessment for Your Application?
              <ArrowRight className="ml-2 h-5 w-5" />
            </Button>
          </Link>
        </div>
      </div>
    </div>
  )
}